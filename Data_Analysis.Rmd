---
title: "AIR QUALITY INDEX-INDIA DATA ANALYSIS"
subtitle: "Statistical Methods II Spring Project"
author: "RishiDarkDevil"
date: "6/27/2021"
output: 
  html_document:
    keep_md: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(lubridate)
library(modelr)
library(psych)
library(car)
library(GGally)
library(ggpubr)
library(ggrepel)
library(purrr)
library(knitr)
library(kableExtra)
library(stringr)
library(viridis)
library(formattable)
options(dplyr.summarise.inform = FALSE)
```

```{r raw_data, cache=TRUE, include=FALSE}
# Importing my data sets
air_data_world <- read_csv("E:\\MY COLLEGE\\ISI KOLKATA\\1ST YEAR\\PROJECTS\\2ND SEM\\STATISTICAL METHODS II\\Air Quality Index\\all_air_data.csv", comment = '#')
air_data_world
station_list <- readxl::read_excel("E:\\MY COLLEGE\\ISI KOLKATA\\1ST YEAR\\PROJECTS\\2ND SEM\\STATISTICAL METHODS II\\Air Quality Index\\Station_List.xlsx", skip = 1)
```

```{r processed_data, cache=TRUE, dependson="raw_data", include=FALSE}
# Separating out the date column for easier analysis
air_data_world <- air_data_world %>%
  mutate(Year = year(Date), Month = month(Date), Day = day(Date)) %>%
  select(Year, Month, Day, Country, City, Specie, count, min, max, median, variance)

# Filtering Data relevant to INDIA
air_data_india <- air_data_world %>%
  filter(Country == "IN")
air_data_india <- air_data_india %>%
  select(Year:Day, City:variance)
air_data_india
air_data_india_withDate <- air_data_world %>%
  filter(Country =="IN")

# Changing some basic flaws in data
correct <- function(x) return(ifelse(x == "wind speed", "wind-speed", x))
air_data_india$Specie <- correct(air_data_india$Specie)
correct <- function(x) return(ifelse(x == "wind gust", "wind-gust", x))
air_data_india$Specie <- correct(air_data_india$Specie)
air_data_india <- air_data_india %>%
  filter(Specie != "wd")
correct <- function(x) return(ifelse(x == "New Delhi", "Delhi", x))
air_data_india$City <- correct(air_data_india$City)

# Arranging the Data according to Year
air_data_india <- air_data_india %>%
  arrange(Year, Month, Day)
air_data_india

# Trying to separate the column Specie for easier analysis -- widening the data
spec1 <- air_data_india %>%
  build_wider_spec(names_from = Specie, values_from = c(count, min, max, median, variance, Year, Month, Day, City))
spec1
# Separate based on Specie
air_data_india_Specie <- air_data_india %>%
  group_by(Specie) %>%
  mutate(row = row_number()) %>%
  pivot_wider_spec(spec1) %>%
  select(-row) %>%
  select(contains("Year"), contains("Month"), contains("Day"), contains("City"), everything())
air_data_india_Specie

# Separate based on City
spec2 <- air_data_india %>%
  build_wider_spec(names_from = City, values_from = c(Specie, count, min, max, median, variance, Year, Month, Day, City))
spec2

air_data_india_City <- air_data_india %>%
  group_by(City) %>%
  mutate(row = row_number()) %>%
  pivot_wider_spec(spec2) %>%
  select(-row) %>%
  select(contains("Year"), contains("Month"), contains("Day"), contains("City"), everything())
air_data_india_City

# Filtering out the pollutants only
air_data_india_pollutants <- air_data_india %>%
  filter(Specie %in% c('pm25', 'pm10', 'o3', 'so2', 'no2', 'co'))

# Filtering out the non-pollutants
air_data_india_nonpollutants <- air_data_india %>%
  filter(!(Specie %in% c('pm25', 'pm10', 'o3', 'so2', 'no2', 'co')))

# What Columns are present in my Data?
colnames(air_data_india)
unique(air_data_india$City)
unique(air_data_india$Specie)

# Making List of Stations.
colnames(station_list) <- c("Sl.No.State", "State", "Sl.No.City", "City", "Sl.No.Station", "Station")
station_list <- station_list %>%
  select(State, City, Station) %>%
  fill(State) %>%
  fill(City) %>%
  fill(Station)
station_list

station_list <- station_list %>%
  filter(City %in% unique(air_data_india$City)) %>%
  group_by(State, City) %>%
  summarise("Number of Stations" = n())
```

# INTRODUCTION

In this Data Analysis Project, I am going to work with **Air Quality Index Data of India**. I will be using several Statistical Tools to Analyze the Data which includes Exploratory Data Analysis, Techniques and methodologies used for Inference and will be Modelling the Data to summarize any pattern or general trend.

I will also try to find out if there was any significant drop in the levels pollutant gases in the Atmosphere due to imposing lockdowns in the year 2020 and 2021, when several industries, factories, transportation facilities were suspended to work. I will be comparing the data for 2020 and 2021 with the previous years.

### UNDERSTANDING THE DATASET

Let's take a look at the Data

```{r}
kable(head(air_data_india), caption = "First few rows of the Air Quality Index Data") %>%
  kable_styling(position = "center")
kable(tail(air_data_india), caption = "Last few rows of the Air Quality Index Data") %>%
  kable_styling(position = "center")
```

-   This Data set contains `r nrow(air_data_india)` rows and `r ncol(air_data_india)` columns.

-   The Year ranges from 2014 to 2021 (till June), with observations recorded on each of the 30 /31 days of the month for 12 months.

-   The Data is generated from the `r length(unique(air_data_india$City))` City Stations for Real-Time Air-Quality Index Monitoring across the Country. The Cities include:

```{r}
kable(station_list, caption = "City Stations") %>%
  kable_styling(position = "center")
```

-   The parameters which we measure at the different Stations are given under the Specie Column and it includes -

```{r Specie_description}
Specie_description <- tibble(
  Parameters = unique(air_data_india$Specie),
  Description = c(
    "Particle pollution/particulate matter(particles less than or equal to 2.5 micrometers in diameter)",
    "Particle pollution/particulate matter(particles less than or equal to 10 micrometers in diameter)",
    "Ground-level ozone",
    "Sulfur dioxide",
    "Nitrogen dioxide",
    "Carbon Monoxide",
    "Temperature",
    "Air Pressure",
    "Wind Gust/Force",
    "Relative Humidity",
    "Wind Speed",
    "Dew Point",
    "Precipitation"
  ),
  Units = c("AQI","AQI","AQI","AQI","AQI","AQI","Degree Celcius",NA,NA,NA,NA,NA,NA)
)
kable(Specie_description, caption = "Specie Description") %>%
  kable_styling(position = "center")
```

The Air Quality Index (AQI) is an index for reporting air quality on a daily basis. It measures air pollution affects one's health within a short time period. The purpose of the AQI is to help people know how the local air quality impacts their health. The measurements in AQI are particularly helpful for our Data Analysis as it helps us compare the values at different stations and time points.

-   It also helps in identifying faulty standards and inadequate monitoring programmes.

-   AQI helps in analysing the change in air quality (improvement or degradation).

-   Comparing air quality conditions at different locations/cities.

```{r AQI_Info}
AQI_Info <- tibble(
  "AQI Values" = c(
    "0-50",
    "51-100",
    "101-150",
    "151-200",
    "201-300",
    "301-500"
  ),
  "Level of Health Concern" = c(
    "Good",
    "Moderate",
    "Unhealthy for sensitive group",
    "Unhealthy",
    "Very Unhealthy",
    "Hazardous"
  )
)
kable(AQI_Info, caption = "Significance of the AQI Values") %>%
  kable_styling(position = "center")
```

In further Analysis we will call pm25, pm10, o3, so2, no2 and co2 as pollutants and the remaining parameters as non-pollutants.

-   For Each parameters in Specie we measure it's minimum value, median value, maximum value and variance . The count variable is the number of times the measurement was taken for each of the parameters.

### TOP CITY STATIONS

Here we try to analyze which City Stations

-   Records More Observations compared to others, which will give us an idea of those centres being more frequently continuously recorded, which can be due to higher AQI Levels in the pollutants.

```{r obsv_per_station}
obsv_per_station <- air_data_india %>%
  group_by(Year, City) %>%
  count() %>%
  arrange(Year, desc(n)) %>%
  spread(key = Year, value = n) %>%
  arrange(desc(`2019`, `2020`, `2021`))

kable(head(obsv_per_station), caption = "Observations recorded per City Station per Year") %>%
  kable_styling(position = "center")
```

It is clearly visible that Delhi is definitely the most monitored centre, which is due to the presence the highest number of Real-Time Air Monitoring Stations in Delhi and more frequent montioring which is due to high AQI Levels which we will see in further analysis. The other centres have more or less the same number of observations.

-   Now Let's take a look at the Average Median AQI Levels of the Pollutants every year Station-wise. The Top 11 Stations will be considered in the further analysis where ever we need to do a Station-wise breakdown of Data or Analysis.

```{r avg_median_per_year_per_station}
avg_median_per_year_per_station <- air_data_india_pollutants %>%
  group_by(Year, City) %>%
  summarise(Median = mean(median)) %>%
  arrange(desc(Year, Median)) %>%
  spread(key = Year, value = Median) %>%
  arrange(desc(`2021`, `2020`, `2019`, `2018`))

kable(avg_median_per_year_per_station, caption = "Average Median AQI Levels of Top 11 City Stations") %>%
  kable_styling(position = "center")
```

# VISUAL OVERVIEW

-   Here we will look at several visualization to get an approximate idea about the spread, patterns, trends and key facts to notice about the Data, which will greatly impact our further Analysis and will prove helpful in finding out the parts of the Data which needs to be observed and tested carefully to provide valuable insight.

```{r Yearly_Station_Bar, fig.asp=0.618, fig.width=8}
air_data_india_pollutants %>%
  group_by(Year, City) %>%
  summarise(Median = mean(median)) %>%
  arrange(desc(Year, Median)) %>%
  filter(Year != 2014) %>%
  ggplot(aes(Year, Median)) +
  geom_bar(aes(fill = City), position = "dodge", stat = "identity") +
  labs(
    y = "Average Median AQI Levels"
  ) +
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 2,
      override.aes = list(size = 3)
    )
  ) +
  scale_fill_viridis(discrete = TRUE)
```

Here, from above bar plot, we see that the year 2020 was the one with the least levels of Pollutants compared to all the other years. 2021 has seen a hike in the AQI levels, which maybe due to opening of the factories, industries and also starting of Transportation facilities in many States. Though we cannot totally claim that, because we don't have data pertaining to entire of 2021.

```{r City_AQI_Box, fig.asp=0.618, fig.width=8}
air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)), City %in% avg_median_per_year_per_station$City[1:11]) %>%
  ggplot(aes(City, median, fill =cut_width(Year, 1))) +
  geom_boxplot(outlier.shape = NA) + 
  coord_cartesian(ylim = c(0, 350)) +
  labs(y = "Average Median AQI Levels", fill = "Year") +
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  )
```

Taking look at the Top 11 Stations we can also see a drop in the AQI levels in the year 2020.

-   Here is an interesting relationship between month and average AQI levels per day of that Month, where we see that the AQI levels in each Measure drop almost linearly till July each year and then it starts rising. We will later explore this relationship in the Modelling Part of this Analysis.

```{r AQI_Yearly_Viz, fig.asp=0.618, fig.width=8}
Monthly_Pollutant <- air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017))) %>%
  group_by(Year, Month) %>%
  summarise(Avg_Min = mean(min), Avg_Median = mean(median), Avg_Max = mean(max))

Monthly_Pollutant_1 <- Monthly_Pollutant %>%
  gather(Avg_Min, Avg_Median, Avg_Max, key = "Measure", value = "AQI")

Monthly_Pollutant_1 %>%
  ggplot(aes(Month, AQI)) +
  geom_point(aes(color = Year, shape = Measure), size = 6, alpha = 0.66) +
  labs(
    y = "Average AQI Levels"
  ) +
  scale_color_viridis(option = "H")
```

-   The Past 4 years Station-wise we can see the same pattern with Delhi being at the top of each month. This answers the question of why Delhi has so many more Observations recorded per year as compared to the other Stations. It's the concerning and high levels of AQI levels.

-   Now we see even more revealing pattern when we plot our Top 11 Station's Measure of AQI Levels in the last 4 years. The Maximum AQI Levels measured each day per month increases and then decreases till July where previously in the above plot which merged all the Stations didn't showed this much. This kind of behavior is ore pronounced in Delhi.

```{r Station_Monthly_Viz, fig.asp=0.618, fig.width=12}
Monthly_Pollutant_City <- air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)) & City %in% avg_median_per_year_per_station$City[1:11]) %>%
  group_by(Year, Month, City) %>%
  summarise(Avg_Min = mean(min), Avg_Median = mean(median), Avg_Max = mean(max))

Monthly_Pollutant_City_1 <- Monthly_Pollutant_City %>%
  gather(Avg_Min, Avg_Median, Avg_Max, key = "Measure", value = "AQI")

Monthly_Pollutant_City_1 %>%
  ggplot(aes(Month, AQI)) +
  geom_point(aes(color = City, alpha = 0.7, shape = Measure), size = 4) +
  facet_wrap(~Year) +
  scale_color_viridis(discrete = TRUE, option = "H")
```

-   Let's turn to the Pollutant-wise breakdown of the AQI Levels, which may help us find out weather it was actually the Lockdowns which may have caused a dip in the AQI levels during the year 2020.

```{r Specie_Yearly_Viz, fig.asp=0.618, fig.width=8}
Yearly_Specie <- air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017))) %>%
  group_by(Year, Specie) %>%
  summarise(Avg_Min = mean(min), Avg_Median = mean(median), Avg_Max = mean(max))

Yearly_Specie_1 <- Yearly_Specie %>%
  gather(Avg_Min, Avg_Median, Avg_Max, key = "Measure", value = "AQI") %>%
  spread(key = Specie, value = AQI)

air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017))) %>%
  gather(min, median, max, key = "Measure", value = "AQI") %>%
  ggplot(aes(Specie, AQI, fill = cut_width(Year, 1))) +
  geom_boxplot(outlier.shape = NA) +
  coord_cartesian(ylim = c(0,300)) +
  labs(fill = "Year")+
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  )
```

Here we can clearly see that each Pollutant has decreased in the Year 2020 compared to all the other Years. But more interesting is the fact that particuate matter of both sizes have shown a big drop. Particulate Matters are mostly contributed by Vehicles, Transportation facilities and some Industries like Cement, etc. Since, there was lockdown we see it might have caused such a dip. Other Pollutants have also seen drop in the Year 2020. Further in the Analysis we will do Statistical Tests to find out if these drops were significant or not.

```{r Monthly_Pollutant_Viz, fig.asp=0.618, fig.width=8}
Monthly_Specie <- air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017))) %>%
  group_by(Year, Month, Specie) %>%
  summarise(Avg_Min = mean(min), Avg_Median = mean(median), Avg_Max = mean(max))
 

Monthly_Specie_1 <- Monthly_Specie %>%
  gather(Avg_Min, Avg_Median, Avg_Max, key = "Measure", value = "AQI") %>%
  spread(key = Specie, value = AQI)


Monthly_Specie_2 <- Monthly_Specie_1 %>%
  gather(co:so2, key = "Pollutants", value = "AQI")

Monthly_Specie_2 %>%
  ggplot(aes(Month, AQI)) +
  geom_point(aes(color = Pollutants, shape = Measure), alpha = 0.66, size = 5) +
  labs(
    y = "Average AQI Levels"
  ) +
  facet_wrap(~Year) +
  scale_color_viridis(discrete = TRUE, option = "B")
```

### DISTRIBUTIONS

Distributions are key in deciding any changes been made to the system generating the data. They help us distinguish between two different groups. They help us look at the spread of the data and helps us take important decisions regarding what inferential techniques we can use and what sort of assumptions are valid. They are also fundamental part before doing any kind of Testing or Model Building.

-   Let's take a look at the Yearly Distribution of the Median AQI Levels

```{r Yearly_Pollutant_Hist, fig.asp=0.618, fig.width=8}
air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)) & !(Specie %in% c('pm25', 'pm10'))) %>%
  ggplot(aes(median, ..density.., fill = cut_width(Year,1), group = Year)) +
  geom_histogram(binwidth = 0.5) +
  coord_cartesian(xlim = c(0, 50)) +
  facet_wrap(~Year) +
  labs(fill = "Year", x = "Median AQI Levels[Excluding pm10 & pm25]", y = "Density")+
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  ) +
  scale_fill_viridis(discrete = TRUE)
```

They look quite familiar to Gamma Distribution. Later in the Inference Part we will try to find out the parameters and will do several Tests to verify this. We will also perform tests for whether the Year 2020 saw a dip in these AQI Levels.

We see more or less same distribution for Maximum AQI Levels and Minimum AQI Levels.

```{r Yearly_Pollutant_Hist_1, fig.asp=0.618, fig.width=8, out.width='.49\\linewidth',fig.show='hold',fig.align='center'}
air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)) & !(Specie %in% c('pm25', 'pm10'))) %>%
  ggplot(aes(max, ..density.., fill = cut_width(Year,1), group = Year)) +
  geom_histogram(binwidth = 1) +
  coord_cartesian(xlim = c(0, 200)) +
  facet_wrap(~Year) +
  labs(fill = "Year", x = "Max AQI Levels[Excluding pm10 & pm25]", y = "Density")+
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  ) +
  scale_fill_viridis(discrete = TRUE)

air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)) & !(Specie %in% c('pm25', 'pm10'))) %>%
  ggplot(aes(min, ..density.., fill = cut_width(Year,1), group = Year)) +
  geom_histogram(binwidth = 0.1) +
  coord_cartesian(xlim = c(0, 10)) +
  facet_wrap(~Year) +
  labs(fill = "Year", x = "Min AQI Levels[Excluding pm10 & pm25]", y = "Density")+
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  ) +
  scale_fill_viridis(discrete = TRUE)
```

-   A Pollutant-wise (Excluding pm10 and pm25) breakdown of the Median AQI Levels also reveal similar Gamma looking Distributions but with different parameters.

```{r Yearly_Indiv_Pollutant_Hist, fig.asp=0.618, fig.width=12}
air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)) & !(Specie %in% c('pm25', 'pm10'))) %>%
  ggplot(aes(median, ..density.., fill = Specie, group = Specie)) +
  geom_histogram(binwidth = 0.5) +
  coord_cartesian(xlim = c(0, 30)) +
  facet_wrap(~Year + Specie, labeller = label_wrap_gen(multi_line=FALSE)) +
  labs(fill = "Year", x = "Median AQI Levels[Excluding pm10 & pm25]", y = "Density")+
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  ) +
  scale_fill_viridis(discrete = TRUE)
```

-   Now in all these above plots we have skipped pm10 and pm25 since they have much higher values of AQI compared to these gases. So, we won't be able to fit them in the above plots. Added with that pm25 doesn't seem to follow some known distribution. We will later see if any transformation or change can help us model that.

```{r Yearly_Indiv_Pollutant_Hist_2, fig.asp=0.618, fig.width=12}
air_data_india_pollutants %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017)) & (Specie %in% c('pm25', 'pm10'))) %>%
  ggplot(aes(median, ..density.., fill = cut_width(Year,1), group = Year)) +
  geom_histogram(binwidth = 5) +
  coord_cartesian(xlim = c(0, 200)) +
  facet_wrap(~Year + Specie, labeller = label_wrap_gen(multi_line=FALSE)) +
  labs(fill = "Year", x = "Median AQI Levels", y = "Density")+
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  ) +
  scale_fill_viridis(discrete = TRUE)
```

### RELATIONSHIPS - PATTERNS & TRENDS

Here we are going to explore the visual relationships between all the pollutants with all the other pollutants and not only that, it is important to realize that the non-pollutants also play a crucial role in deciding the level of pollutants measured. We will see more of it below in this section as well as a lot of it in the section where we build our Models. These relationships are best exposed with Scatter plots. Here we will take a look at these.

-   Here we look at the Scatter Plot matrix of the Pollutants where we have summarized the data in Yearly & Monthly basis so as to make the plots less overwhelming and more interpretable. We see strong correlation between all these marginals plots. Which can be attributed due to the conversions of one gas to the other that takes place naturally in the atmosphere. But we must also be careful that it may happen that these individual pollutants are related due to some other underlying common feature, which we will explore further in the Model Building section.

```{r Monthly_Specie_Scatterplot_Matrix, fig.asp=0.618, fig.width=12, message=FALSE, warning=FALSE}
# Exploring the relationships between All Species with each other Monthly
air_data_india_All_Specie_Monthly <- air_data_india %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017))) %>%
  group_by(Year, Month, Specie) %>%
  summarise(Avg_Min = mean(min, na.rm = TRUE), Avg_Median = mean(median, na.rm = TRUE), Avg_Max = mean(max, na.rm = TRUE))

air_data_india_All_Specie_Monthly_1 <- air_data_india_All_Specie_Monthly %>%
  gather(Avg_Min, Avg_Median, Avg_Max, key = "Measure", value = "AQI")

air_data_india_All_Specie_Monthly_2 <- air_data_india_All_Specie_Monthly_1 %>%
  spread(key = Specie, value = AQI)

# Actually here all the parameters with all the others except Year and Month are really highly correlated. So let's take a look at them 
air_data_india_All_Specie_Monthly_2 %>%
  ggpairs(columns = c("co", "no2", "o3", "so2", "pm10", "pm25"), aes(color = cut_width(Year, 1), shape = cut_width(Year, 1)), progress = FALSE) +
  scale_color_viridis(discrete = TRUE)

air_data_india_All_Specie_Monthly_2 %>%
  filter(Year != 2018) %>% # There is a lot of Missing values in this year
  ggpairs(columns = c("dew", "humidity", "pressure", "temperature", "wind-gust", "wind-speed"), aes(color = cut_width(Year, 1), shape = cut_width(Year, 1)), progress = FALSE) +
  scale_color_viridis(discrete = TRUE)
```

Here we see that the non-pollutants also have strong correlations among themselves, which can be attributed for the fact that temperature, pressure, humidity, wind-speed, etc. are physically strongly related.

-   Let's take a look at the dependence of the Pollutants on Non-Pollutants

```{r Monthly_Pol_non_Pol_Scatterplot_Matrix, fig.asp=0.618, fig.width=12}
air_data_india_Pollutants_nonpollutants_monthly <- air_data_india_All_Specie_Monthly_1 %>%
  filter(Year != 2018) %>% # There is a lot of Missing values in this year
  spread(key = Specie, value = AQI) %>%
  select(-precipitation) %>%
  gather(dew, humidity, pressure, temperature, `wind-gust`, `wind-speed`, key = "non_pollutants", value = Levels) %>%
  gather(co, so2, no2, o3, pm10, pm25, key = "pollutants", value = "AQI")

air_data_india_Pollutants_nonpollutants_monthly %>%
  ggplot(aes(AQI, Levels, color = cut_width(Year, 1))) +
  geom_point() +
  scale_color_viridis(discrete = TRUE) +
  facet_wrap(~pollutants + non_pollutants, scales = "free", labeller = label_wrap_gen(multi_line=FALSE)) +
  labs(color = "Year") +
  theme(legend.position = "bottom") +
  guides(
    fill = guide_legend(
      nrow = 1
    )
  ) +
  coord_flip() +
  scale_fill_viridis(discrete = TRUE)
```

There is a significiant relationship between each of the non-pollutants on the AQI levels of the pollutants, which may be due to the fact that wind speeds, temperature, pressure, humidity, etc. changes the concentration of the pollutants in the Air. There are other physical processes in nature that also strongly intertwine them. We will see more of it in the later sections.

<<<<<<< HEAD
-   There is also one more thing which can prove to be really helpful in understanding the relationship between the pollutants that is the variance of these parameters measured each day at the stations at real-time. Where we can see how these parameters variances are related. I haven't included the scatterplot matrix of the non-pollutants and of the pollutants and non-pollutants, as they visually don't convey much. But we will surely work with them in the later section.

```{r Monthly_Pol_non_Pol_Scatterplot_Matrix_Var, fig.asp=0.618, fig.width=12, message=FALSE, warning=FALSE}
air_data_india_All_Specie_Monthly_var <- air_data_india %>%
  filter(!(Year %in% c(2014, 2015, 2016, 2017))) %>%
  group_by(Year, Month, Specie) %>%
  summarise(Avg_Variance = mean(variance, na.rm = TRUE))

air_data_india_All_Specie_Monthly_var_1 <- air_data_india_All_Specie_Monthly_var %>%
  spread(key = Specie, value = Avg_Variance)

air_data_india_All_Specie_Monthly_var_1 %>%
  ggpairs(columns = c("co", "no2", "o3", "so2", "pm10", "pm25"), aes(color = cut_width(Year, 1), shape = cut_width(Year, 1)), progress = FALSE) +
  scale_color_viridis(discrete = TRUE)

air_data_india_Pollutants_nonpollutants_monthly_var_1 <- air_data_india_All_Specie_Monthly_var_1 %>%
  filter(Year != 2018) %>% # There is a lot of Missing values in this year
  select(-precipitation) %>%
  gather(dew, humidity, pressure, temperature, `wind-gust`, `wind-speed`, key = "non_pollutants", value = "Levels_variance") %>%
  gather(co, so2, no2, o3, pm10, pm25, key = "pollutants", value = "AQI_variance")
```

=======
>>>>>>> e59644dfd767f8702e1811a1c9df0b96b044b831
So, with this visual picture of the Data in mind. We wrap the Visual Overview and most part of the EDA here. In the next section we will draw inferences from the data using several Inferential Statistical Technique.
